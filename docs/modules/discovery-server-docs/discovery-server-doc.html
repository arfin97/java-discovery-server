<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Discovery Server: Eureka</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1>Discovery Server: Eureka</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_eureka">1. Eureka</a></li>
<li><a href="#_role_of_service_disovery">2. Role of Service Disovery</a></li>
<li><a href="#_components_of_eureka_server_and_workflow">3. Components of Eureka Server and Workflow</a></li>
<li><a href="#_get_up_and_running_eureka_server_configuration">4. Get up and Running: Eureka Server Configuration</a></li>
<li><a href="#_get_up_and_running_eureka_client_configuration">5. Get up and Running: Eureka Client Configuration</a></li>
<li><a href="#_getting_the_urls">6. Getting the URLS</a>
<ul class="sectlevel2">
<li><a href="#_using_resttemplate_and_discoveryserver">6.1. Using RestTemplate and DiscoveryServer</a></li>
<li><a href="#_using_instance_object">6.2. Using Instance object</a></li>
</ul>
</li>
<li><a href="#_eureka_client_configuration_making_environment_agnostic">7. Eureka Client configuration: Making environment agnostic</a></li>
<li><a href="#_clustering_multiple_discovery_servers">8. Clustering Multiple Discovery Servers</a></li>
<li><a href="#_health_of_a_microservice">9. Health of a Microservice</a>
<ul class="sectlevel2">
<li><a href="#_how_eureka_ensures_health">9.1. How Eureka Ensures Health</a></li>
<li><a href="#_self_preservation_mechanism">9.2. Self-Preservation Mechanism</a>
<ul class="sectlevel3">
<li><a href="#_self_preservation_data_calculation_example">9.2.1. Self-Preservation Data Calculation Example</a></li>
<li><a href="#_simulating_an_ungraceful_shutdown_situation">9.2.2. Simulating an ungraceful shutdown situation.</a></li>
<li><a href="#_self_preservation_configurations">9.2.3. Self-Preservation Configurations</a></li>
<li><a href="#_get_health_data_through_actuator">9.2.4. Get health Data through Actuator.</a></li>
</ul>
</li>
<li><a href="#_more_health_of_a_service">9.3. More Health of a Service</a></li>
<li><a href="#_demo_create_a_custom_health_check">9.4. Demo: Create a custom health check</a></li>
<li><a href="#_service_health_summery">9.5. Service Health Summery</a></li>
</ul>
</li>
<li><a href="#_registry_cacheing">10. Registry Cacheing</a></li>
<li><a href="#_advanced_configurations">11. Advanced Configurations</a>
<ul class="sectlevel2">
<li><a href="#_three_types_of_configuration">11.1. Three types of configuration</a></li>
<li><a href="#_advance_configuration_options">11.2. Advance configuration options</a></li>
</ul>
</li>
<li><a href="#_securing_the_eureka_server">12. Securing The Eureka Server</a>
<ul class="sectlevel3">
<li><a href="#_authenticating_with_the_eureka_server">12.1. Authenticating with the Eureka Server</a></li>
<li><a href="#_registering_a_secure_application">12.2. Registering a Secure Application</a></li>
</ul>
</li>
<li><a href="#_miscellaneous">13. Miscellaneous</a></li>
<li><a href="#_aws_support">14. AWS Support</a></li>
<li><a href="#_resources">15. Resources</a>
<ul class="sectlevel2">
<li><a href="#_start">15.1. Start</a></li>
<li><a href="#_clustering">15.2. Clustering</a></li>
<li><a href="#_health">15.3. Health</a></li>
<li><a href="#_aws_support_2">15.4. AWS Support</a></li>
<li><a href="#_how_to_open_multiple_projects_in_intellij">15.5. How to open multiple projects in IntelliJ</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_eureka">1. Eureka</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre>It's a registry that acts like a phone-book for your microservices. Eureka itself is a rest-based service, primarily used by Netflix in their AWS Cloud for finding services, for load balancing fail over, and mainly for middle-tier services. It's a really powerful tool for helping you kind of register these things dynamically. There's no database behind the scenes. It's really actually made up of a live look at the health of individual systems. It's an AP system if you look at cap theorem. So it's okay to sacrifice consistency, because it prioritizes availability and partition tolerance.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_role_of_service_disovery">2. Role of Service Disovery</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="role-of-service-discovery.png" alt="role of service discovery">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_components_of_eureka_server_and_workflow">3. Components of Eureka Server and Workflow</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="eureka-workflow.png" alt="eureka workflow">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_up_and_running_eureka_server_configuration">4. Get up and Running: Eureka Server Configuration</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make A discover server project from spring initializer (Eureka Server). This is a basic spring project with Eureka Server. To configure it to an actual Eureka server and to see the Eureka Dashboard we need to do some steps.</p>
</li>
<li>
<p>Add an <code>server.port=8761</code>.</p>
</li>
<li>
<p>Make the server non-client. All Eureka Servers are default clients. We don’t need this functionality unless we have multiple eureka server.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">server.port=8761
spring.application.name=discovery-server
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If last two lines are not added you&#8217;ll get exception like. Because it will try to register itself with another eureka server.
<code>TransportException: Cannot execute request on any known server</code>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>registerWithEureka:</code> If we make this property as true then while the server starts the inbuilt client will try to register itself with the Eureka server.
<code>fetchRegistry:</code> The inbuilt client will try to fetch the Eureka registry if we configure this property as true.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Add Eureka Server Annotation in main class.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@SpringBootApplication</span>
<span style="color:#007">@EnableEurekaServer</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DiscoveryServerApplication</span> {
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
                SpringApplication.run(DiscoveryServerApplication.class, args);
        }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you get XML errors, you need to add some libraries as Java 11 Doesn’t support those now. But Cloud Hoxton Versions are now compatible with Java 11 So you might not need them.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Go to <a href="http://localhost:8761" class="bare">http://localhost:8761</a> to see the <code>Eureka-Dashboard</code>. At the moment, we see basic indicators such as status and health indicators.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="eureka-dashboard.png" alt="eureka dashboard">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_get_up_and_running_eureka_client_configuration">5. Get up and Running: Eureka Client Configuration</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Init a project using <code>Eureka Client</code> dependency or Make all the projects to Eureka Client by adding Eureka Client Dependency.</p>
</li>
<li>
<p>Add application name and port in properties file.</p>
</li>
<li>
<p>They will automatically find the 8761 port as no explicit server is configured. And they will register themselves as the application.name property.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Then we need to annotate with either @EnableDiscoveryClient or @EnableEurekaClient – note that this annotation is optional if we have the spring-cloud-starter-netflix-eureka-client dependency on the classpath.
@EnableDiscoveryClient is generic and will work with discovery services other than eureka.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Go to dashboard to see the registerd services</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="eureka-instances.png" alt="eureka instances">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="eureka-service-discovery.png" alt="eureka service discovery">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="disvoery-client-2.png" alt="disvoery client 2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_the_urls">6. Getting the URLS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_using_resttemplate_and_discoveryserver">6.1. Using RestTemplate and DiscoveryServer</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add @LoadBalanced to RestTemplateBean.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@SpringBootApplication</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieServiceApplication</span> {
        <span style="color:#007">@Bean</span>
        <span style="color:#007">@LoadBalanced</span>
        <span style="color:#088;font-weight:bold">public</span> RestTemplate getRestTemplate(){
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> RestTemplate();
        }
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
                SpringApplication.run(MovieServiceApplication.class, args);
        }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Change the names of HardCoded URLS to application name to make it fully discover server dependent. Add load balanced annotation into your rest template.
@RestController
public class MovieController {</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Autowired</span>
<span style="color:#088;font-weight:bold">private</span> RestTemplate restTemplate;
    <span style="color:#007">@RequestMapping</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/movie</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Movie getMovie(){
        <span style="color:#777">//MovieName movieName = restTemplate.getForObject(&quot;http://localhost:8082/name&quot;, MovieName.class);</span>
        <span style="color:#777">//MovieDetail movieDetail = restTemplate.getForObject(&quot;http://localhost:8083/detail&quot;, MovieDetail.class);</span>
        MovieName movieName = restTemplate.getForObject(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://movie-name-service/name</span><span style="color:#710">&quot;</span></span>, MovieName.class);
        MovieDetail movieDetail = restTemplate.getForObject(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://movie-detail-service/detail</span><span style="color:#710">&quot;</span></span>, MovieDetail.class);
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Movie(movieName.getName(), movieDetail.getMovieDetail());
    }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_using_instance_object">6.2. Using Instance object</h3>
<div class="paragraph">
<p>We can use loadbalancer to insert our url using @LoadBalancer or we can manually use <code>Instance Object</code> to go through all the
instances of a service and pick their URL to inject.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="instance-object.png" alt="instance object">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_eureka_client_configuration_making_environment_agnostic">7. Eureka Client configuration: Making environment agnostic</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span style="color:#606">spring</span>:
  <span style="color:#606">application</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">spring-cloud-eureka-client</span></span>
<span style="color:#606">server</span>:
  <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">0</span></span>
<span style="color:#606">eureka</span>:
  <span style="color:#606">client</span>:
    <span style="color:#606">serviceUrl</span>:
      <span style="color:#606">defaultZone</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">${EUREKA_URI:http://localhost:8761/eureka}</span></span>
  <span style="color:#606">instance</span>:
    <span style="color:#606">preferIpAddress</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>${EUREKA_URI:http://localhost:8761/eureka}</code> is the key here.
EUREKA_URI will be replaced by the configuration value defiend in configuration file. Or it will fall back to the default <code>EUREKA_URI:http://localhost:8761/eureka</code>
When we decided to set up our Eureka Client this way, we had in mind that this kind of service should later be easily scalable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clustering_multiple_discovery_servers">8. Clustering Multiple Discovery Servers</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We need different host name to setup multiple discovery server. Go to <code>C:\Windows\System32\drivers\etc</code></p>
</li>
<li>
<p>Copy the host file in desktop to edit (You cannot edit in etc folder). Before editing make a backup copy of it.</p>
</li>
<li>
<p>Add the following lines</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="file">        127.0.0.1       localhost
        127.0.0.1       localhost2</code></pre>
</div>
</div>
</li>
<li>
<p>Make two discovery server as before. Name them `discovery-server</p>
</li>
<li>
<p>Give <code>server.port=8761</code> to one server and <code>server.port=8762</code> to another</p>
</li>
<li>
<p>Add the following properties in <code>8761</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">spring.application.name=eureka-naming-server
server.port=8761
eureka.instance.hostname:localhost
eureka.client.serviceUrl.defaultZone:http://localhost2:8762/eureka/
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following properties in <code>8762</code></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">spring.application.name=eureka-naming-server
server.port=8762
eureka.instance.hostname:localhost2
eureka.client.serviceUrl.defaultZone:http://localhost:8761/eureka/
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false</code></pre>
</div>
</div>
</li>
<li>
<p>Run both of them and see each other can detect themselves and showed in DS Replicas.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is a pattern called gossiping in Consule that works like facebook mutual friends finding to look for discovery server.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In real life you&#8217;ll have the configuration files in Configuration Server. So you won&#8217;t have to hard code the
details of each server in all the instances.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_health_of_a_microservice">9. Health of a Microservice</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_how_eureka_ensures_health">9.1. How Eureka Ensures Health</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When server starts it sends a "Regester me" REST request.</p>
</li>
<li>
<p>When it goes down it sends "Unregister me" REST request.</p>
</li>
<li>
<p>If "Unregister me" call received it deletes the data. It is a safe way to deregister. It is knowns as "Graceful Shutdown".</p>
</li>
<li>
<p>But Ungraceful shutdown can happen. To handle ungraceful client shutdowns the server expects "Register me" request from the client at specific intervals.
It is knowns as <code>heartbeeats</code></p>
</li>
<li>
<p>By default the server expects heartbeats every 30 seconds. This is knowns are <code>renewal</code></p>
</li>
<li>
<p>The server sets a <code>renewal threashold</code> that determiens how many renewal it <strong>should</strong> get if all the instances are healthy.</p>
</li>
<li>
<p>If the renewal count is less than threashold, it doens&#8217;t immidietly delete the instance. This mechanism knowns as <code>self-preservation</code></p>
</li>
<li>
<p>It is very unlikely that 900 instance are down out of 1000 at the same time. This might be caused due to a
network problem or maintanance shcedule. To handle these types of situation <code>self preservation mode</code> is introduced.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is set by default, so in your learning stage you might have confusion why this thing is necessary.
The real benefit of self-preservation mode can be realized if there is a lot of microservices.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>eureka.instance.hostname=localhost</code> is particularly important since we&#8217;re running it in a local machine. Otherwise, we may end up creating an unavailable replica within the Eureka server – messing up the client&#8217;s heartbeat counts.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_self_preservation_mechanism">9.2. Self-Preservation Mechanism</h3>
<div class="sect3">
<h4 id="_self_preservation_data_calculation_example">9.2.1. Self-Preservation Data Calculation Example</h4>
<div class="paragraph">
<p>From the screenshot, we can see that our Eureka server has six registered client instances and the total renewal threshold is 11. The threshold calculation is based on three factors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Total number of registered client instances – 6</p>
</li>
<li>
<p>Configured client renewal interval – 30 seconds</p>
</li>
<li>
<p>The configured renewal percentage threshold – 0.85</p>
</li>
<li>
<p>Considering all these factors, in our case, the threshold is 11.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="self-preservation-calculation.png" alt="self preservation calculation">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_simulating_an_ungraceful_shutdown_situation">9.2.2. Simulating an ungraceful shutdown situation.</h4>
<div class="paragraph">
<p>In order to simulate a temporary network problem,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the property <code>eureka.client.should-unregister-on-shutdown=false</code> at the client-side</p>
</li>
<li>
<p>Stop the client instance.</p>
</li>
<li>
<p>Because we set the should-unregister-on-shutdown flag as false,  the client won&#8217;t invoke the unregister call and the server assumes that this is an ungraceful shutdown.</p>
</li>
<li>
<p>Now wait for 90 seconds set by our <code>eureka.instance.lease-expiration-duration-in-seconds</code> property.</p>
</li>
<li>
<p>Eureka Server is now in self-preservation mode and stopped evicting instances.</p>
</li>
<li>
<p>Let&#8217;s now inspect the registered instances section to see if the stopped instance is still available or not. As we can see, it is available but with the status as DOWN:</p>
</li>
<li>
<p>The only way the server can get out of self-preservation mode is either by starting the stopped instance or by disabling self-preservation itself.</p>
</li>
<li>
<p>If we repeat the same steps by setting the flag eureka.server.enable-self-preservation as false, then the Eureka server will evict the stopped instance from the registry after the configured lease expiration duration property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>By default, Eureka servers run with self-preservation enabled.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="_self_preservation_configurations">9.2.3. Self-Preservation Configurations</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>eureka.server.enable-self-preservation:</code> Configuration for disabling self-preservation – the default value is true</p>
</li>
<li>
<p><code>eureka.server.expected-client-renewal-interval-seconds:</code> The server expects client heartbeats at an interval configured with this property – the default value is 30</p>
</li>
<li>
<p><code>eureka.instance.lease-expiration-duration-in-seconds:</code> Indicates the time in seconds that the Eureka server waits since it received the last heartbeat from a client before it can remove that client from its registry – the default value is 90</p>
</li>
<li>
<p><code>eureka.server.eviction-interval-timer-in-ms:</code> This property tells the Eureka server to run a job at this frequency to evict the expired clients – the default value is 60 seconds</p>
</li>
<li>
<p><code>eureka.server.renewal-percent-threshold:</code> Based on this property, the server calculates the expected heartbeats per minute from all the registered clients – the default value is 0.85</p>
</li>
<li>
<p><code>eureka.server.renewal-threshold-update-interval-ms:</code> This property tells the Eureka server to run a job at this frequency to calculate the expected heartbeats from all the registered clients at this minute – the default value is 15 minutes</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In most cases, the default configuration is sufficient. But for specific requirements, we might want to change these configurations. Utmost care needs to be taken in those cases to avoid unexpected consequences like wrong renew threshold calculation or delayed self-preservation mode activation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_get_health_data_through_actuator">9.2.4. Get health Data through Actuator.</h4>
<div class="paragraph">
<p>You can get your service health information with a helpful endpoint spring boot actuator gives.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add <code>Spring Boot Actuator</code> dependency in pom file.</p>
</li>
<li>
<p>Go to <code><a href="http://localhost:8080/health" class="bare">http://localhost:8080/health</a></code> to see the health information in JSON format.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_more_health_of_a_service">9.3. More Health of a Service</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Heartbeat only tells if the service is alive or not. It doesn&#8217;t tell if it is healthy or not.</p>
</li>
<li>
<p>But it is possible to include more health informations. We can create our own health indicator.</p>
</li>
<li>
<p>Our custom health indicator can indicate health of a service every few secconds and it can also
have the mechanism to register or deregister itself from the registry based on our custom logic.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_demo_create_a_custom_health_check">9.4. Demo: Create a custom health check</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add <code>eureka.client.healtcheck.enabled=true</code></p>
</li>
<li>
<p>Create a classn named <code>CustomHealthCheck</code> or anything you want.</p>
</li>
<li>
<p>Implement `HealthIndicator' interface to your class.</p>
<div class="listingblock">
<div class="title">Code</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CustomHealthCheck</span> <span style="color:#088;font-weight:bold">implements</span> HealthIndicator {
        <span style="color:#339;font-weight:bold">int</span> errorcode = <span style="color:#00D">0</span>;
        <span style="color:#007">@Override</span>
        <span style="color:#088;font-weight:bold">public</span> Health health() {
                <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">health check performed, error code is </span><span style="color:#710">&quot;</span></span> + errorcode);
                <span style="color:#080;font-weight:bold">if</span>(errorcode &gt; <span style="color:#00D">4</span> &amp;&amp; errorcode &lt; <span style="color:#00D">10</span>) {
                        errorcode++;
                        <span style="color:#080;font-weight:bold">return</span> Health.down().withDetail(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Custom Error Code</span><span style="color:#710">&quot;</span></span>, errorcode).build();
                }
                <span style="color:#080;font-weight:bold">else</span> {
                        errorcode++;
                        <span style="color:#080;font-weight:bold">return</span> Health.up().build();
                }
        }
}</code></pre>
</div>
</div>
</li>
<li>
<p>After 4 iteration our output will be the following</p>
<div class="imageblock">
<div class="content">
<img src="custom-healthcheck-output.png" alt="custom healthcheck output">
</div>
<div class="title">Figure 1. Output</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_service_health_summery">9.5. Service Health Summery</h3>
<div class="imageblock">
<div class="content">
<img src="are-services-healthy.png" alt="are services healthy">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="health-in-eureka.png" alt="health in eureka">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_registry_cacheing">10. Registry Cacheing</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Discovery server was created with high availability in mind.</p>
</li>
<li>
<p>Each client gets a copy of regestry, so if the discovery server is down. They can still talk to each other.</p>
</li>
<li>
<p>If there is a change in the registry, the client is smart enough to fetch only the deltas(changes) to
update the registry.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="discovery-server-caching.png" alt="discovery server caching">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_configurations">11. Advanced Configurations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_three_types_of_configuration">11.1. Three types of configuration</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>eureka.server.* &#8594; For server configurations.</p>
</li>
<li>
<p>eureka.client.* &#8594; For how client interacts with discovery server. (Time out)</p>
</li>
<li>
<p>eureka.instance.* &#8594; For instances are things that are registered in Eureka Server. (Hostname, Healthcheck)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_advance_configuration_options">11.2. Advance configuration options</h3>
<div class="paragraph">
<p>Eureka comes with a lot of default features out of the box. But you can also configure tons of things.
Some of the things are..</p>
</div>
<div class="imageblock">
<div class="content">
<img src="advanced-configuration-opitons.png" alt="advanced configuration opitons">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_securing_the_eureka_server">12. Securing The Eureka Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To be updated&#8230;&#8203;.</p>
</div>
<div class="sect3">
<h4 id="_authenticating_with_the_eureka_server">12.1. Authenticating with the Eureka Server</h4>

</div>
<div class="sect3">
<h4 id="_registering_a_secure_application">12.2. Registering a Secure Application</h4>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_miscellaneous">13. Miscellaneous</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Instance ID</p>
</li>
<li>
<p>Zones</p>
</li>
<li>
<p>EurekaClient without Jersey</p>
</li>
<li>
<p>Refreshing Eureka Clients</p>
</li>
<li>
<p>Spring Cloud LoadBalancer</p>
</li>
<li>
<p>Peer Awareness</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aws_support">14. AWS Support</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Application that uses discovery server checks if it is deployed in AWS environment. If so, it fetches all the
necessary meta data for the environment automatically like: Amazon Machine Image, Zone etc. It sends
these information to the discovery server when it registers.</p>
</li>
<li>
<p>Elastic IP binding support: Eureka Server automatically binds itself to next available elastic IP address.</p>
</li>
<li>
<p>Eureka-Client is Zone aware. So it will contact the current zone discovery server.</p>
</li>
<li>
<p>Multi-Region Aware.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">15. Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_start">15.1. Start</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/">Spring Cloud Netflix</a> [Eureka Official Docs]</p>
</li>
<li>
<p><a href="https://www.baeldung.com/spring-cloud-netflix-eureka">Introduction to Spring Cloud Netflix – Eureka</a> [baeldung]</p>
</li>
<li>
<p><a href="https://spring.io/guides/gs/service-registration-and-discovery/">Service Registration and Discovery</a> [Spring Quick Starter Project]</p>
</li>
<li>
<p><a href="https://app.pluralsight.com/player?course=spring-cloud-fundamentals&amp;author=dustin-schultz&amp;name=spring-cloud-fundamentals-m2&amp;clip=0&amp;mode=live">Spring Cloud Fundamentals.</a> [Pluralsight]</p>
</li>
<li>
<p><a href="https://app.pluralsight.com/player?course=java-microservices-spring-cloud-coordinating-services&amp;author=richard-seroter&amp;name=d3021dfd-e6af-4065-a89a-c3e953e982d0&amp;clip=0&amp;mode=live">Java Microservices with Spring Cloud: Coordinating Services.</a> [Pluralsight]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_clustering">15.2. Clustering</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://medium.com/become-developer/how-to-work-with-multiple-instances-of-eureka-naming-server-to-avoid-a-single-point-of-failure-d953544281d0">How to work with multiple instances of Eureka Naming Server to avoid a single point of failure</a> [Medium Article]</p>
</li>
<li>
<p><a href="https://tech.asimio.net/2017/03/06/Multi-version-Service-Discovery-using-Spring-Cloud-Netflix-Eureka-and-Ribbon.html">Multi-version Service Discovery using Spring Cloud Netflix Eureka and Ribbon</a> [Article]</p>
</li>
<li>
<p><a href="https://cloud.spring.io/spring-cloud-netflix/reference/html/#netflix-eureka-server-starter">How to Include Eureka Server</a> [Spring Documentation]</p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/42554653/how-to-create-multiple-instances-of-eureka-services-registered-into-eureka-servi">how to create multiple instances of eureka services registered into eureka service registry?</a> [StackOverflow]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_health">15.3. Health</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.baeldung.com/eureka-self-preservation-renewal">Guide to Eureka Self Preservation and Renewal</a> [baeldung]</p>
</li>
<li>
<p><a href="https://github.com/Netflix/eureka/wiki/Understanding-Eureka-Peer-to-Peer-Communication">Understanding Eureka Peer to Peer Communication</a> [Documentation]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_aws_support_2">15.4. AWS Support</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://aws.amazon.com/marketplace/pp/CallMiner-Inc-Eureka-Starter-Edition/B075X29S3C">Eureka - Starter Edition - AWS Marketplace</a> [AWS Eureka Docs]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_open_multiple_projects_in_intellij">15.5. How to open multiple projects in IntelliJ</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.youtube.com/watch?v=9pRf3VRXEdo">IntelliJ Workspace Tips - Multiple Repositories in One Workspace</a> [Youtube]</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-04-30 21:48:07 +0600
</div>
</div>
</body>
</html>